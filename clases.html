<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Clases de Inglés</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* RESET Y BASE */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f7fa;
            color: #333;
            transition: margin-left 0.3s;
        }

        body.panel-open {
            margin-left: 280px;
        }

        /* HEADER SIMPLIFICADO */
        .header {
            background: linear-gradient(135deg, #1d3c6e 0%, #2a5298 100%);
            color: white;
            padding: 12px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo h1 {
            font-size: 1.3rem;
            font-weight: 900;
            color: white;
        }

        .logo span {
            color: #ff6b6b;
        }

        .menu-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            transition: transform 0.3s;
        }

        .menu-btn:hover {
            transform: scale(1.1);
        }

        /* PANEL LATERAL */
        .side-panel {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: linear-gradient(180deg, #1d3c6e 0%, #2a5298 100%);
            color: white;
            z-index: 1000;
            transition: left 0.3s ease;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }

        .side-panel.open {
            left: 0;
        }

        .panel-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .user-info-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .user-avatar-panel {
            width: 60px;
            height: 60px;
            background-color: #c41e1e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1.2rem;
            border: 3px solid white;
        }

        .user-name-panel {
            font-weight: 700;
            font-size: 1rem;
        }

        .user-role-panel {
            background-color: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .user-level-panel {
            background-color: rgba(37, 211, 102, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 5px;
            color: #25D366;
            border: 1px solid rgba(37, 211, 102, 0.3);
        }

        .panel-nav {
            padding: 20px 0;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-title {
            padding: 0 20px 10px;
            font-size: 0.8rem;
            text-transform: uppercase;
            opacity: 0.7;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background-color: rgba(255,255,255,0.1);
            border-left-color: #c41e1e;
        }

        .nav-item.active {
            background-color: rgba(255,255,255,0.15);
            border-left-color: #25D366;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        .nav-item-text {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .nav-item.badge {
            position: relative;
        }

        .nav-badge {
            position: absolute;
            right: 20px;
            background-color: #c41e1e;
            color: white;
            border-radius: 10px;
            padding: 2px 6px;
            font-size: 0.7rem;
            font-weight: 700;
        }

        /* Solo para profesores */
        .teacher-only {
            display: none;
        }

        .is-teacher .teacher-only {
            display: flex;
        }

        .logout-panel {
            margin-top: auto;
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .logout-btn-panel {
            background-color: rgba(196, 30, 30, 0.3);
            color: white;
            border: 1px solid rgba(196, 30, 30, 0.5);
            border-radius: 5px;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .logout-btn-panel:hover {
            background-color: rgba(196, 30, 30, 0.5);
        }

        /* CONTENIDO PRINCIPAL */
        .main-content {
            padding: 20px;
            min-height: calc(100vh - 56px);
        }

        /* MENSAJES */
        .message {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
        }

        .message.info {
            background-color: rgba(29, 60, 110, 0.1);
            color: #1d3c6e;
            border: 1px solid #1d3c6e;
        }

        .message.success {
            background-color: rgba(37, 211, 102, 0.1);
            color: #25D366;
            border: 1px solid #25D366;
        }

        .message.error {
            background-color: rgba(196, 30, 30, 0.1);
            color: #c41e1e;
            border: 1px solid #c41e1e;
        }

        /* PÁGINA DE CLASES (estudiantes) */
        .classes-page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .page-title {
            color: #1d3c6e;
            font-weight: 900;
            font-size: 1.8rem;
        }

        .page-subtitle {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* FILTROS REDUCIDOS */
        .filters-container {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .filters-title {
            color: #1d3c6e;
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .filter-btn {
            padding: 6px 16px;
            background-color: #f0f2f5;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            color: #1d3c6e;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn:hover {
            background-color: #e3e8f0;
        }

        .filter-btn.active {
            background-color: #1d3c6e;
            color: white;
            border-color: #1d3c6e;
        }

        /* LISTA DE CLASES */
        .classes-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .class-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid #e0e0e0;
        }

        .class-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .class-header {
            background: linear-gradient(135deg, #1d3c6e 0%, #2a5298 100%);
            color: white;
            padding: 12px;
        }

        .class-level {
            background-color: #c41e1e;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 6px;
        }

        .class-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .class-body {
            padding: 15px;
        }

        .class-description {
            color: #666;
            font-size: 0.85rem;
            line-height: 1.5;
            margin-bottom: 12px;
            min-height: 50px;
        }

        .class-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 12px;
        }

        .class-date {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .class-file {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .class-actions {
            display: flex;
            gap: 8px;
        }

        .download-btn, .edit-btn, .delete-btn {
            flex: 1;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.85rem;
            transition: background-color 0.3s;
        }

        .download-btn {
            background-color: #25D366;
        }

        .download-btn:hover {
            background-color: #1da851;
        }

        .edit-btn {
            background-color: #1d3c6e;
        }

        .edit-btn:hover {
            background-color: #152a50;
        }

        .delete-btn {
            background-color: #c41e1e;
        }

        .delete-btn:hover {
            background-color: #a01818;
        }

        /* PÁGINA DE ESTUDIANTES (profesor) */
        .students-container {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .students-table {
            width: 100%;
            border-collapse: collapse;
        }

        .students-table th {
            background-color: #f8f9fa;
            padding: 12px 15px;
            text-align: left;
            font-weight: 700;
            color: #1d3c6e;
            border-bottom: 2px solid #e0e0e0;
            font-size: 0.85rem;
        }

        .students-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.85rem;
        }

        .student-avatar {
            width: 32px;
            height: 32px;
            background-color: #1d3c6e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 0.8rem;
        }

        .student-level-select {
            padding: 6px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            background-color: #f9f9f9;
            cursor: pointer;
        }

        .student-level-select:focus {
            outline: none;
            border-color: #1d3c6e;
        }

        .student-action-btn {
            padding: 6px 12px;
            background-color: #c41e1e;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .student-action-btn:hover {
            background-color: #a01818;
        }

        /* PÁGINA DE GESTIÓN DE CLASES (profesor) */
        .manage-classes-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .upload-class-btn {
            align-self: flex-end;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .upload-class-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }

        /* SIN CONTENIDO */
        .no-content {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .no-content i {
            font-size: 2.5rem;
            color: #e0e0e0;
            margin-bottom: 15px;
        }

        .no-content h3 {
            color: #1d3c6e;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        /* MODALES */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background-color: white;
            width: 100%;
            max-width: 500px;
            border-radius: 12px;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(135deg, #1d3c6e 0%, #2a5298 100%);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: #1d3c6e;
            font-weight: 600;
            margin-bottom: 6px;
            font-size: 0.85rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            transition: border-color 0.3s;
            background-color: #f9f9f9;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1d3c6e;
            background-color: white;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .file-upload {
            border: 2px dashed #e0e0e0;
            padding: 15px;
            text-align: center;
            border-radius: 6px;
            background-color: #f9f9f9;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .file-upload:hover {
            border-color: #1d3c6e;
        }

        .file-upload input {
            display: none;
        }

        .file-info {
            margin-top: 8px;
            font-size: 0.8rem;
            color: #666;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .submit-btn {
            flex: 1;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .submit-btn:hover {
            background-color: #1da851;
        }

        .cancel-btn {
            flex: 1;
            background-color: #c41e1e;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .cancel-btn:hover {
            background-color: #a01818;
        }

        /* ANIMACIONES */
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            body.panel-open {
                margin-left: 0;
            }
            
            .side-panel {
                width: 100%;
                left: -100%;
            }
            
            .side-panel.open {
                left: 0;
            }
            
            .classes-container {
                grid-template-columns: 1fr;
            }
            
            .students-table {
                display: block;
                overflow-x: auto;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .upload-class-btn {
                align-self: stretch;
                text-align: center;
            }
            
            .modal-body {
                padding: 15px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
        }

    </style>
</head>
<body>

    <!-- HEADER SIMPLIFICADO -->
    <header class="header">
        <div class="logo">
            <h1>Clases de <span>Inglés</span></h1>
        </div>
        <button class="menu-btn" id="menuBtn">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <!-- PANEL LATERAL -->
    <div class="side-panel" id="sidePanel">
        <div class="panel-header">
            <div class="user-info-panel">
                <div class="user-avatar-panel" id="userAvatarPanel">JS</div>
                <div class="user-name-panel" id="userNamePanel">Cargando...</div>
                <div class="user-role-panel" id="userRolePanel">Estudiante</div>
                <div class="user-level-panel" id="userLevelPanel">Sin nivel asignado</div>
            </div>
        </div>

        <div class="panel-nav">
            <!-- Opción para todos -->
            <div class="nav-section">
                <div class="nav-title">Navegación</div>
                <div class="nav-item active" data-page="classes">
                    <i class="fas fa-book-open"></i>
                    <span class="nav-item-text">Mis Clases</span>
                </div>
            </div>

            <!-- Opciones solo para profesores -->
            <div class="nav-section teacher-only">
                <div class="nav-title">Administración</div>
                <div class="nav-item" data-page="manage-classes">
                    <i class="fas fa-tasks"></i>
                    <span class="nav-item-text">Gestionar Clases</span>
                </div>
                <div class="nav-item" data-page="students">
                    <i class="fas fa-users"></i>
                    <span class="nav-item-text">Estudiantes</span>
                    <span class="nav-badge" id="studentsBadge">0</span>
                </div>
            </div>

            <div class="nav-section teacher-only">
                <div class="nav-title">Acciones</div>
                <div class="nav-item" id="uploadClassBtn">
                    <i class="fas fa-upload"></i>
                    <span class="nav-item-text">Subir Nueva Clase</span>
                </div>
            </div>
        </div>

        <div class="logout-panel">
            <button class="logout-btn-panel" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </button>
        </div>
    </div>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="main-content">
        <!-- Mensajes globales -->
        <div id="message" class="message"></div>

        <!-- Página: Clases para estudiantes -->
        <div class="page classes-page active" id="classesPage">
            <div class="page-header">
                <div>
                    <h2 class="page-title">Mis Clases de Inglés</h2>
                    <p class="page-subtitle" id="classesSubtitle">Accede al material de tu nivel</p>
                </div>
            </div>

            <!-- Mensaje para estudiantes sin nivel -->
            <div class="message info" id="noLevelMessage" style="display: none;">
                <i class="fas fa-info-circle"></i>
                Debes esperar a que el profesor te asigne un nivel para ver las clases.
            </div>

            <!-- Filtros (solo cuando hay nivel) -->
            <div class="filters-container" id="filtersContainer" style="display: none;">
                <div class="filters-title">
                    <i class="fas fa-filter"></i> FILTRAR POR NIVEL
                </div>
                <div class="filters">
                    <button class="filter-btn active" data-level="A1">A1 - BÁSICO INICIAL</button>
                    <button class="filter-btn" data-level="A2">A2 - BÁSICO FUNCIONAL</button>
                    <button class="filter-btn" data-level="B1">B1 - INTERMEDIO</button>
                </div>
            </div>

            <!-- Contenedor de clases -->
            <div class="classes-container" id="classesContainer"></div>

            <!-- Sin clases disponibles -->
            <div class="no-content" id="noClasses" style="display: none;">
                <i class="fas fa-folder-open"></i>
                <h3>No hay clases disponibles</h3>
                <p>El profesor aún no ha subido material para tu nivel.</p>
            </div>
        </div>

        <!-- Página: Gestionar Clases (profesor) -->
        <div class="page" id="manageClassesPage">
            <div class="page-header">
                <div>
                    <h2 class="page-title">Gestionar Clases</h2>
                    <p class="page-subtitle">Administra todas las clases del sistema</p>
                </div>
                <button class="upload-class-btn" id="openUploadModal">
                    <i class="fas fa-upload"></i> SUBIR NUEVA CLASE
                </button>
            </div>

            <div class="filters-container">
                <div class="filters-title">
                    <i class="fas fa-filter"></i> FILTRAR POR NIVEL
                </div>
                <div class="filters">
                    <button class="filter-btn active" data-level="all">TODAS</button>
                    <button class="filter-btn" data-level="A1">A1</button>
                    <button class="filter-btn" data-level="A2">A2</button>
                    <button class="filter-btn" data-level="B1">B1</button>
                </div>
            </div>

            <div class="manage-classes-container">
                <div class="classes-container" id="manageClassesContainer"></div>
                <div class="no-content" id="noManageClasses" style="display: none;">
                    <i class="fas fa-folder-open"></i>
                    <h3>No has subido clases aún</h3>
                    <p>Comienza subiendo tu primera clase.</p>
                </div>
            </div>
        </div>

        <!-- Página: Estudiantes (profesor) -->
        <div class="page" id="studentsPage">
            <div class="page-header">
                <div>
                    <h2 class="page-title">Gestionar Estudiantes</h2>
                    <p class="page-subtitle">Administra los estudiantes registrados</p>
                </div>
            </div>

            <div class="students-container">
                <table class="students-table">
                    <thead>
                        <tr>
                            <th>Estudiante</th>
                            <th>Usuario</th>
                            <th>Nivel Asignado</th>
                            <th>Fecha Registro</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <!-- Los estudiantes se cargarán aquí -->
                    </tbody>
                </table>
                <div class="no-content" id="noStudents" style="display: none;">
                    <i class="fas fa-users"></i>
                    <h3>No hay estudiantes registrados</h3>
                    <p>Los estudiantes aparecerán aquí cuando se registren.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: Subir/Editar Clase -->
    <div class="modal-overlay" id="classModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">SUBIR NUEVA CLASE</div>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            
            <div class="modal-body">
                <form id="classForm">
                    <input type="hidden" id="classId" value="">
                    
                    <div class="form-group">
                        <label for="classTitle"><i class="fas fa-heading"></i> Título de la Clase</label>
                        <input type="text" id="classTitle" placeholder="Ej: Present Simple Tense" required>
                    </div>

                    <div class="form-group">
                        <label for="classDescription"><i class="fas fa-align-left"></i> Descripción</label>
                        <textarea id="classDescription" placeholder="Describe el contenido de esta clase..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="classCategory"><i class="fas fa-tag"></i> Categoría / Nivel</label>
                        <select id="classCategory" required>
                            <option value="">Selecciona un nivel</option>
                            <option value="A1">A1 - Básico Inicial</option>
                            <option value="A2">A2 - Básico Funcional</option>
                            <option value="B1">B1 - Intermedio</option>
                        </select>
                    </div>

                    <div class="form-group" id="fileUploadGroup">
                        <label><i class="fas fa-file-upload"></i> Seleccionar Archivo</label>
                        <div class="file-upload" id="fileUploadArea">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 1.8rem; color: #1d3c6e; margin-bottom: 8px;"></i>
                            <div>Haz clic para seleccionar un archivo</div>
                            <input type="file" id="classFile" accept=".pdf,.doc,.docx,.ppt,.pptx,.txt,.jpg,.png,.mp3,.mp4">
                            <div class="file-info" id="fileInfo">Formatos aceptados: PDF, DOC, PPT, TXT, JPG, PNG, MP3, MP4</div>
                        </div>
                        <div id="currentFileInfo" style="display: none; margin-top: 10px; padding: 10px; background-color: #f0f7ff; border-radius: 6px;">
                            <strong>Archivo actual:</strong> <span id="currentFileName"></span>
                            <br>
                            <small>Selecciona un nuevo archivo solo si deseas cambiarlo</small>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="submit" class="submit-btn" id="modalSubmitBtn">
                            <i class="fas fa-upload"></i> SUBIR CLASE
                        </button>
                        <button type="button" class="cancel-btn" id="cancelModal">
                            CANCELAR
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmar Eliminación -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #c41e1e 0%, #d63031 100%);">
                <div class="modal-title">Confirmar Eliminación</div>
                <button class="close-modal" id="closeConfirmModal">&times;</button>
            </div>
            
            <div class="modal-body">
                <p id="confirmMessage">¿Estás seguro de que deseas eliminar este elemento?</p>
                <div class="modal-actions">
                    <button type="button" class="submit-btn" id="confirmDeleteBtn" style="background-color: #c41e1e;">
                        <i class="fas fa-trash"></i> ELIMINAR
                    </button>
                    <button type="button" class="cancel-btn" id="cancelDeleteBtn">
                        CANCELAR
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentUser = null;
        let currentPage = 'classes';
        let currentFilter = 'A1';
        let manageFilter = 'all';
        let pendingAction = null;
        let pendingData = null;

        // Elementos del DOM
        const menuBtn = document.getElementById('menuBtn');
        const sidePanel = document.getElementById('sidePanel');
        const logoutBtn = document.getElementById('logoutBtn');
        const messageEl = document.getElementById('message');
        const userAvatarPanel = document.getElementById('userAvatarPanel');
        const userNamePanel = document.getElementById('userNamePanel');
        const userRolePanel = document.getElementById('userRolePanel');
        const userLevelPanel = document.getElementById('userLevelPanel');
        const studentsBadge = document.getElementById('studentsBadge');
        
        // Elementos de páginas
        const classesPage = document.getElementById('classesPage');
        const manageClassesPage = document.getElementById('manageClassesPage');
        const studentsPage = document.getElementById('studentsPage');
        const navItems = document.querySelectorAll('.nav-item');
        
        // Elementos de clases para estudiantes
        const classesContainer = document.getElementById('classesContainer');
        const noClassesEl = document.getElementById('noClasses');
        const noLevelMessage = document.getElementById('noLevelMessage');
        const filtersContainer = document.getElementById('filtersContainer');
        const classesSubtitle = document.getElementById('classesSubtitle');
        const filterBtns = document.querySelectorAll('.filter-btn');
        
        // Elementos de gestión de clases
        const manageClassesContainer = document.getElementById('manageClassesContainer');
        const noManageClasses = document.getElementById('noManageClasses');
        const manageFilterBtns = document.querySelectorAll('#manageClassesPage .filter-btn');
        
        // Elementos de estudiantes
        const studentsTableBody = document.getElementById('studentsTableBody');
        const noStudents = document.getElementById('noStudents');
        
        // Elementos modales
        const classModal = document.getElementById('classModal');
        const confirmModal = document.getElementById('confirmModal');
        const closeModalBtn = document.getElementById('closeModal');
        const cancelModalBtn = document.getElementById('cancelModal');
        const closeConfirmModalBtn = document.getElementById('closeConfirmModal');
        const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
        const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
        const classForm = document.getElementById('classForm');
        const modalTitle = document.getElementById('modalTitle');
        const modalSubmitBtn = document.getElementById('modalSubmitBtn');
        const fileUploadGroup = document.getElementById('fileUploadGroup');
        const currentFileInfo = document.getElementById('currentFileInfo');
        const currentFileName = document.getElementById('currentFileName');
        const classFileInput = document.getElementById('classFile');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInfoEl = document.getElementById('fileInfo');
        const uploadClassBtn = document.getElementById('uploadClassBtn');
        const openUploadModalBtn = document.getElementById('openUploadModal');

        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            setupEventListeners();
        });

        function checkAuth() {
            const userData = localStorage.getItem('current_user');
            const authToken = localStorage.getItem('auth_token');
            
            if (!userData || !authToken) {
                window.location.href = 'auth.html';
                return;
            }

            currentUser = JSON.parse(userData);
            displayUserInfo();
            setupRoleBasedUI();
            
            // Cargar datos iniciales según el rol
            if (currentUser.role === 'student') {
                checkStudentLevel();
            } else if (currentUser.role === 'teacher') {
                loadStudents();
                loadAllClasses();
            }
        }

        function displayUserInfo() {
            // Información del usuario en el panel
            userNamePanel.textContent = currentUser.name;
            userRolePanel.textContent = currentUser.role === 'teacher' ? 'PROFESOR' : 'ESTUDIANTE';
            
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            userAvatarPanel.textContent = initials.substring(0, 2);
            
            // Mostrar nivel si tiene
            if (currentUser.level && currentUser.level !== 'Sin asignar') {
                const levelText = getLevelText(currentUser.level);
                userLevelPanel.textContent = `Nivel: ${levelText}`;
                userLevelPanel.style.display = 'block';
            } else {
                userLevelPanel.style.display = 'none';
            }
        }

        function setupRoleBasedUI() {
            const isTeacher = currentUser.role === 'teacher';
            
            // Mostrar/ocultar opciones de profesor
            if (isTeacher) {
                document.body.classList.add('is-teacher');
            }
            
            // Configurar título según rol
            if (isTeacher) {
                document.title = `Panel de Profesor - Clases de Inglés`;
            }
        }

        function setupEventListeners() {
            // Panel lateral
            menuBtn.addEventListener('click', togglePanel);
            
            // Cerrar panel al hacer clic fuera en móvil
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 && 
                    !sidePanel.contains(e.target) && 
                    e.target !== menuBtn &&
                    sidePanel.classList.contains('open')) {
                    togglePanel();
                }
            });

            // Navegación
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    if (page) {
                        switchPage(page);
                        navItems.forEach(nav => nav.classList.remove('active'));
                        item.classList.add('active');
                    }
                });
            });

            // Botón de subir clase en panel
            uploadClassBtn?.addEventListener('click', () => {
                switchPage('manage-classes');
                openClassModal();
            });

            // Botón de subir clase en página de gestión
            openUploadModalBtn?.addEventListener('click', openClassModal);

            // Cerrar sesión
            logoutBtn.addEventListener('click', () => {
                localStorage.removeItem('current_user');
                localStorage.removeItem('auth_token');
                window.location.href = 'auth.html';
            });

            // Filtros de clases (estudiantes)
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.level;
                    loadClasses();
                });
            });

            // Filtros de gestión (profesor)
            manageFilterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    manageFilterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    manageFilter = btn.dataset.level;
                    loadAllClasses();
                });
            });

            // Modales
            closeModalBtn.addEventListener('click', closeClassModal);
            cancelModalBtn.addEventListener('click', closeClassModal);
            closeConfirmModalBtn.addEventListener('click', closeConfirmModal);
            cancelDeleteBtn.addEventListener('click', closeConfirmModal);
            confirmDeleteBtn.addEventListener('click', executePendingAction);

            // Subir archivo
            fileUploadArea.addEventListener('click', () => classFileInput.click());
            classFileInput.addEventListener('change', handleFileSelect);

            // Formulario de clase
            classForm.addEventListener('submit', handleClassSubmit);

            // Cerrar modales al hacer clic fuera
            [classModal, confirmModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        if (modal === classModal) closeClassModal();
                        if (modal === confirmModal) closeConfirmModal();
                    }
                });
            });
        }

        function togglePanel() {
            sidePanel.classList.toggle('open');
            document.body.classList.toggle('panel-open');
        }

        function switchPage(page) {
            // Ocultar todas las páginas
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            // Mostrar la página solicitada
            currentPage = page;
            
            switch(page) {
                case 'classes':
                    classesPage.classList.add('active');
                    checkStudentLevel();
                    break;
                    
                case 'manage-classes':
                    manageClassesPage.classList.add('active');
                    loadAllClasses();
                    break;
                    
                case 'students':
                    studentsPage.classList.add('active');
                    loadStudents();
                    break;
            }
            
            // Cerrar panel en móvil
            if (window.innerWidth <= 768) {
                togglePanel();
            }
        }

        async function checkStudentLevel() {
            if (currentUser.role !== 'student') return;
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch('/api/profile', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                if (response.ok) {
                    const profile = await response.json();
                    currentUser.level = profile.level;
                    displayUserInfo();
                    
                    if (currentUser.level && currentUser.level !== 'Sin asignar') {
                        // Mostrar filtros y clases
                        noLevelMessage.style.display = 'none';
                        filtersContainer.style.display = 'block';
                        classesSubtitle.textContent = `Nivel actual: ${getLevelText(currentUser.level)}`;
                        loadClasses();
                    } else {
                        // Mostrar mensaje de espera
                        noLevelMessage.style.display = 'block';
                        filtersContainer.style.display = 'none';
                        classesContainer.innerHTML = '';
                        noClassesEl.style.display = 'block';
                    }
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function loadClasses() {
            if (currentUser.role !== 'student') return;
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const level = currentUser.level === currentFilter ? currentUser.level : currentFilter;
                
                const response = await fetch(`/api/classes?level=${level}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.status === 401) {
                    window.location.href = 'auth.html';
                    return;
                }

                const classes = await response.json();
                displayClasses(classes);
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error al cargar las clases', 'error');
            }
        }

        function displayClasses(classes) {
            classesContainer.innerHTML = '';
            
            if (classes.length === 0) {
                classesContainer.style.display = 'none';
                noClassesEl.style.display = 'block';
                return;
            }

            classesContainer.style.display = 'grid';
            noClassesEl.style.display = 'none';
            
            classes.forEach((classItem, index) => {
                const classCard = createClassCard(classItem, index, false);
                classesContainer.appendChild(classCard);
            });
        }

        async function loadAllClasses() {
            if (currentUser.role !== 'teacher') return;
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const url = manageFilter === 'all' 
                    ? '/api/classes/all' 
                    : `/api/classes?level=${manageFilter}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const classes = await response.json();
                    displayAllClasses(classes);
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error al cargar las clases', 'error');
            }
        }

        function displayAllClasses(classes) {
            manageClassesContainer.innerHTML = '';
            
            if (classes.length === 0) {
                manageClassesContainer.style.display = 'none';
                noManageClasses.style.display = 'block';
                return;
            }

            manageClassesContainer.style.display = 'grid';
            noManageClasses.style.display = 'none';
            
            classes.forEach((classItem, index) => {
                const classCard = createClassCard(classItem, index, true);
                manageClassesContainer.appendChild(classCard);
            });
        }

        async function loadStudents() {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch('/api/students', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const students = await response.json();
                    displayStudents(students);
                    studentsBadge.textContent = students.length;
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error al cargar estudiantes', 'error');
            }
        }

        function displayStudents(students) {
            studentsTableBody.innerHTML = '';
            
            if (students.length === 0) {
                noStudents.style.display = 'block';
                studentsTableBody.style.display = 'none';
                return;
            }

            noStudents.style.display = 'none';
            studentsTableBody.style.display = 'table-row-group';
            
            students.forEach(student => {
                const row = document.createElement('tr');
                
                const initials = student.name.split(' ').map(n => n[0]).join('').toUpperCase();
                const formattedDate = new Date(student.registration_date).toLocaleDateString('es-ES');
                
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="student-avatar">${initials.substring(0, 2)}</div>
                            <div>
                                <div style="font-weight: 600;">${student.name}</div>
                                <div style="font-size: 0.8rem; color: #666;">${student.email || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td>${student.username}</td>
                    <td>
                        <select class="student-level-select" data-student-id="${student.id}" onchange="updateStudentLevel(${student.id}, this.value)">
                            <option value="Sin asignar" ${student.level === 'Sin asignar' ? 'selected' : ''}>Sin asignar</option>
                            <option value="A1" ${student.level === 'A1' ? 'selected' : ''}>A1 - Básico Inicial</option>
                            <option value="A2" ${student.level === 'A2' ? 'selected' : ''}>A2 - Básico Funcional</option>
                            <option value="B1" ${student.level === 'B1' ? 'selected' : ''}>B1 - Intermedio</option>
                        </select>
                    </td>
                    <td>${formattedDate}</td>
                    <td>
                        <button class="student-action-btn" onclick="deleteStudent(${student.id}, '${student.name}')">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                    </td>
                `;
                
                studentsTableBody.appendChild(row);
            });
        }

        // Funciones globales para estudiantes
        window.updateStudentLevel = async function(studentId, level) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`/api/students/${studentId}/level`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ level })
                });

                if (response.ok) {
                    showMessage('Nivel actualizado exitosamente', 'success');
                    
                    // Si el estudiante actualizó su propio nivel, recargar
                    if (currentUser.role === 'student' && currentUser.id === studentId) {
                        currentUser.level = level;
                        displayUserInfo();
                        checkStudentLevel();
                    }
                } else {
                    showMessage('Error al actualizar el nivel', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error de conexión', 'error');
            }
        };

        window.deleteStudent = function(studentId, studentName) {
            pendingAction = 'deleteStudent';
            pendingData = { id: studentId };
            
            document.getElementById('confirmMessage').textContent = 
                `¿Estás seguro de que deseas eliminar al estudiante "${studentName}"? Esta acción no se puede deshacer.`;
            
            confirmModal.classList.add('active');
        };

        function createClassCard(classItem, index, isManage = false) {
            const card = document.createElement('div');
            card.className = 'class-card';
            card.style.animation = `fadeIn 0.5s ease ${index * 0.1}s both`;

            const levelText = getLevelText(classItem.level);
            const formattedDate = new Date(classItem.created_at).toLocaleDateString('es-ES', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });

            card.innerHTML = `
                <div class="class-header">
                    <div class="class-level">${levelText}</div>
                    <div class="class-title">${classItem.title}</div>
                    ${isManage ? `<div style="font-size: 0.8rem; opacity: 0.9;">Subido por: ${classItem.uploaded_by_name || 'Profesor'}</div>` : ''}
                </div>
                <div class="class-body">
                    <div class="class-description">${classItem.description}</div>
                    <div class="class-meta">
                        <div class="class-date">
                            <i class="far fa-calendar-alt"></i> ${formattedDate}
                        </div>
                        <div class="class-file">
                            <i class="fas fa-file"></i> ${classItem.file_type}
                        </div>
                    </div>
                    <div class="class-actions">
                        ${isManage ? `
                            <button class="edit-btn" onclick="editClass(${classItem.id})">
                                <i class="fas fa-edit"></i> EDITAR
                            </button>
                            <button class="delete-btn" onclick="deleteClass(${classItem.id}, '${classItem.title}')">
                                <i class="fas fa-trash"></i> ELIMINAR
                            </button>
                        ` : ''}
                        <button class="download-btn" onclick="downloadClass(${classItem.id})">
                            <i class="fas fa-download"></i> DESCARGAR
                        </button>
                    </div>
                </div>
            `;

            return card;
        }

        // Funciones globales para clases
        window.editClass = async function(classId) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`/api/classes/${classId}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const classData = await response.json();
                    openClassModal(classData);
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error al cargar la clase', 'error');
            }
        };

        window.deleteClass = function(classId, className) {
            pendingAction = 'deleteClass';
            pendingData = { id: classId };
            
            document.getElementById('confirmMessage').textContent = 
                `¿Estás seguro de que deseas eliminar la clase "${className}"? Esta acción no se puede deshacer.`;
            
            confirmModal.classList.add('active');
        };

        window.downloadClass = async function(classId) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`/api/classes/${classId}/download`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    window.open(data.download_url, '_blank');
                    showMessage('Redirigiendo a descarga...', 'success');
                } else {
                    showMessage('Error al descargar', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error de conexión', 'error');
            }
        };

        function openClassModal(classData = null) {
            classForm.reset();
            
            if (classData) {
                // Modo edición
                modalTitle.textContent = 'EDITAR CLASE';
                modalSubmitBtn.innerHTML = '<i class="fas fa-save"></i> GUARDAR CAMBIOS';
                
                document.getElementById('classId').value = classData.id;
                document.getElementById('classTitle').value = classData.title;
                document.getElementById('classDescription').value = classData.description;
                document.getElementById('classCategory').value = classData.level;
                
                // Mostrar información del archivo actual
                currentFileName.textContent = classData.file_name;
                currentFileInfo.style.display = 'block';
                fileUploadGroup.querySelector('label').innerHTML = '<i class="fas fa-file-upload"></i> Cambiar Archivo (opcional)';
                fileInfoEl.textContent = 'Deja vacío para mantener el archivo actual';
                
                // El archivo no es requerido en edición
                classFileInput.removeAttribute('required');
            } else {
                // Modo creación
                modalTitle.textContent = 'SUBIR NUEVA CLASE';
                modalSubmitBtn.innerHTML = '<i class="fas fa-upload"></i> SUBIR CLASE';
                
                document.getElementById('classId').value = '';
                currentFileInfo.style.display = 'none';
                fileUploadGroup.querySelector('label').innerHTML = '<i class="fas fa-file-upload"></i> Seleccionar Archivo';
                fileInfoEl.textContent = 'Formatos aceptados: PDF, DOC, PPT, TXT, JPG, PNG, MP3, MP4';
                
                // El archivo es requerido en creación
                classFileInput.setAttribute('required', 'required');
            }
            
            classModal.classList.add('active');
        }

        function closeClassModal() {
            classModal.classList.remove('active');
            classForm.reset();
            fileInfoEl.textContent = 'Formatos aceptados: PDF, DOC, PPT, TXT, JPG, PNG, MP3, MP4';
            fileUploadArea.style.borderColor = '#e0e0e0';
            fileUploadArea.style.backgroundColor = '#f9f9f9';
            currentFileInfo.style.display = 'none';
        }

        function closeConfirmModal() {
            confirmModal.classList.remove('active');
            pendingAction = null;
            pendingData = null;
        }

        function executePendingAction() {
            if (!pendingAction || !pendingData) return;
            
            switch(pendingAction) {
                case 'deleteClass':
                    deleteClassConfirmed(pendingData.id);
                    break;
                case 'deleteStudent':
                    deleteStudentConfirmed(pendingData.id);
                    break;
            }
            
            closeConfirmModal();
        }

        async function deleteClassConfirmed(classId) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`/api/classes/${classId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    showMessage('Clase eliminada exitosamente', 'success');
                    loadAllClasses();
                    
                    // Si estamos en la página de clases de estudiantes, recargar también
                    if (currentPage === 'classes') {
                        loadClasses();
                    }
                } else {
                    showMessage('Error al eliminar la clase', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error de conexión', 'error');
            }
        }

        async function deleteStudentConfirmed(studentId) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`/api/students/${studentId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    showMessage('Estudiante eliminado exitosamente', 'success');
                    loadStudents();
                } else {
                    showMessage('Error al eliminar el estudiante', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error de conexión', 'error');
            }
        }

        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                fileInfoEl.innerHTML = `
                    <strong>Archivo seleccionado:</strong> ${file.name}<br>
                    <small>Tamaño: ${(file.size / 1024).toFixed(2)} KB</small>
                `;
                fileUploadArea.style.borderColor = '#25D366';
                fileUploadArea.style.backgroundColor = 'rgba(37, 211, 102, 0.05)';
            }
        }

        async function handleClassSubmit(e) {
            e.preventDefault();
            
            const classId = document.getElementById('classId').value;
            const title = document.getElementById('classTitle').value.trim();
            const description = document.getElementById('classDescription').value.trim();
            const level = document.getElementById('classCategory').value;
            const file = classFileInput.files[0];
            
            if (!title || !description || !level) {
                showMessage('Por favor, completa todos los campos requeridos', 'error');
                return;
            }
            
            // En creación, el archivo es requerido
            if (!classId && !file) {
                showMessage('Debes seleccionar un archivo para la clase', 'error');
                return;
            }
            
            const formData = new FormData();
            formData.append('title', title);
            formData.append('description', description);
            formData.append('level', level);
            if (file) {
                formData.append('file', file);
            }
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const url = classId ? `/api/classes/${classId}` : '/api/classes';
                const method = classId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showMessage(classId ? '¡Clase actualizada exitosamente!' : '¡Clase subida exitosamente!', 'success');
                    closeClassModal();
                    
                    // Recargar las clases según la página actual
                    if (currentPage === 'manage-classes') {
                        loadAllClasses();
                    } else if (currentPage === 'classes') {
                        loadClasses();
                    }
                } else {
                    showMessage(data.error || 'Error al procesar la clase', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error de conexión con el servidor', 'error');
            }
        }

        function getLevelText(category) {
            switch(category) {
                case 'A1': return 'A1 - BÁSICO INICIAL';
                case 'A2': return 'A2 - BÁSICO FUNCIONAL';
                case 'B1': return 'B1 - INTERMEDIO';
                default: return category || 'Sin asignar';
            }
        }

        function showMessage(text, type) {
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;
            
            setTimeout(() => {
                messageEl.className = 'message';
                messageEl.textContent = '';
            }, 3000);
        }

    </script>

</body>
</html>